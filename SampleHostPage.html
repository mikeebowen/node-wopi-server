<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />

    <!-- Enable IE Standards mode -->
    <meta http-equiv="x-ua-compatible" content="ie=edge" />

    <title></title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no" />
    <script src="http://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.12.0.min.js"></script>
    <link rel="shortcut icon" href="http://mikee-oos/wv/resources/1033/FavIcon_Word.ico" />

    <style type="text/css">
      body {
        margin: 0;
        padding: 0;
        overflow: hidden;
        -ms-content-zooming: none;
      }

      #office_frame {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        margin: 0;
        border: none;
        display: block;
      }
      /* The Modal (background) */
      .modal {
        display: none; /* Hidden by default */
        position: fixed; /* Stay in place */
        z-index: 1; /* Sit on top */
        left: 0;
        top: 0;
        width: 100%; /* Full width */
        height: 100%; /* Full height */
        overflow: auto; /* Enable scroll if needed */
        background-color: rgb(0, 0, 0); /* Fallback color */
        background-color: rgba(0, 0, 0, 0.4); /* Black w/ opacity */
      }

      /* Modal Content/Box */
      .modal-content {
        background-color: #fefefe;
        margin: 15% auto; /* 15% from the top and centered */
        padding: 20px;
        border: 1px solid #888;
        width: 80%; /* Could be more or less, depending on screen size */
      }

      /* The Close Button */
      .close {
        color: #aaa;
        float: right;
        font-size: 28px;
        font-weight: bold;
      }

      .close:hover,
      .close:focus {
        color: black;
        text-decoration: none;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div>
      <h1>Mike's WOPI Test Page 10/11/2019 build 001 Host: mikee-oos</h1>
      <p id="demo">language</p>
      <p id="demo_user"></p>
      <p id="demo_browser"></p>
      <p id="demo_system"></p>
      <p>
        Use this page to test the WOPI host implementation based on:
        <a href="https://github.com/Microsoft/Office-Online-Test-Tools-and-Documentation">Office-Online-Test-Tools-and-Documentation</a>
      </p>
      <button class="wopi_vw_button" id="vwDoc">Preview Word Document</button>
      <button class="wopi_vw_button" id="edDoc">Open Word Document</button>
      <button class="wopi_vw_button" id="vwXls">Edit Excel Spreadsheet</button>
      <button class="wopi_vw_button" id="cvXls">Convert Excel Spreadsheet (broken)</button>
      <button class="wopi_vw_button" id="cvDoc">Convert Word Document</button>
      <button class="wopi_em_button" id="embedDoc">Embed Word Document</button>
      <button class="wopi_em_button" id="embedXls">Embed Excel Spreadsheet</button>
      <button class="wopi_pv_button" id="vwPpt">View PowerPoint Presentation</button>
      <button class="wopi_vw_button" id="vwPdf">View PDF</button>
    </div>

    <!--<form id="office_form" name="office_form" target="office_frame"
		  action="<OFFICE_ONLINE_ACTION_URL>" method="post">
		<input name="access_token" value="<ACCESS_TOKEN_VALUE>" type="hidden"/>
		<input name="access_token_ttl" value="<ACCESS_TOKEN_TTL_VALUE>" type="hidden"/>
		</form>-->
    <div>
      <form
        id="office_form_vwDoc"
        name="office_form"
        target="office_frame"
        action="http://mikee-oos/wv/wordviewerframe.aspx?embed=1?&WOPISrc=http%3A%2F%2Fwopi-server:3000%2Fwopi%2Ffiles%2Ftest.docx&access_token=DEADBEEFDEADBEEFDEADBEEF&access_token_ttl=0"
        method="post"
      >
        <input name="WOPIsrc" value="http%3A%2F%2Fwopi-server:3000%2Fwopi%2Ffiles%2Ftest2.docx" type="hidden" />
        <input name="access_token" value="DEADBEEFDEADBEEFDEADBEEF" type="hidden" />
        <input name="access_token_ttl" value="0" type="hidden" />
      </form>
      <form
        id="office_form_edDoc"
        name="office_form"
        target="office_frame"
        action="http://mikee-oos/we/wordeditorframe.aspx?&WOPISrc=http%3A%2F%2Fwopi-server:3000%2Fwopi%2Ffiles%2Ftest10.docx&access_token=DEADBEEFDEADBEEFDEADBEEF&access_token_ttl=0"
        method="post"
      >
        <input name="WOPIsrc" value="http%3A%2F%2Fwopi-server:3000%2Fwopi%2Ffiles%2Ftest10.docx" type="hidden" />
        <input name="access_token" value="DEADBEEFDEADBEEFDEADBEEF" type="hidden" />
        <input name="access_token_ttl" value="0" type="hidden" />
      </form>

      <form
        id="office_form_embedDoc"
        name="office_form"
        target="office_frame"
        action="http://mikee-oos/wv/wordviewerframe.aspx?embed=1&WOPISrc=http%3A%2F%2Fwopi-server:3000%2Fwopi%2Ffiles%2Ftest2.docx&access_token=DEADBEEFDEADBEEFDEADBEEF&access_token_ttl=0"
        method="post"
      >
        <input name="src" value="http://wopi-server:3000%2fSampleHostPage.html/wopi/files/test2.docx" type="hidden" />
        <input name="access_token" value="DEADBEEFDEADBEEFDEADBEEF" type="hidden" />
        <input name="access_token_ttl" value="0" type="hidden" />
      </form>

      <form
        id="office_form_cvXls"
        name="office_form"
        target="office_frame"
        action="http://mikee-oos/x/_layouts/xlviewerinternal.aspx?WOPISrc=http%3A%2F%2Fwopi-server:3000%2Fwopi%2Ffiles%2Ftest1.xlsx&access_token=DEADBEEFDEADBEEFDEADBEEF&access_token_ttl=0"
        method="post"
      >
        <input name="WOPIsrc" value="http%3A%2F%2Fwopi-server:3000%2Fwopi%2Ffiles%2Ftest1.xlsx" type="hidden" />
        <input name="access_token" value="DEADBEEFDEADBEEFDEADBEEF" type="hidden" />
        <input name="access_token_ttl" value="0" type="hidden" />
      </form>

      <form
        id="office_form_cvDoc"
        name="office_form"
        target="office_frame"
        action="http://mikee-oos/we/WordConvertAndEdit.aspx?WOPISrc=http%3A%2F%2Fwopi-server:3000%2Fwopi%2Ffiles%2FTest2.doc&access_token=DEADBEEFDEADBEEFDEADBEEF&access_token_ttl=0"
        method="post"
      >
        <input name="WOPIsrc" value="http%3A%2F%2Fwopi-server:3000%2Fwopi%2Ffiles%2FTest2.doc" type="hidden" />
        <input name="access_token" value="DEADBEEFDEADBEEFDEADBEEF" type="hidden" />
        <input name="access_token_ttl" value="0" type="hidden" />
      </form>

      <form
        id="office_form_vwXls"
        name="office_form"
        target="office_frame"
        action="http://mikee-oos/x/_layouts/xlviewerinternal.aspx?WOPISrc=http%3A%2F%2Fwopi-server:3000%2Fwopi%2Ffiles%2Ftest2.xlsx&access_token=DEADBEEFDEADBEEFDEADBEEF&access_token_ttl=0"
        method="post"
      >
        <input name="WOPIsrc" value="http%3A%2F%2Fwopi-server:3000%2Fwopi%2Ffiles%2Ftest2.xlsx" type="hidden" />
        <input name="access_token" value="DEADBEEFDEADBEEFDEADBEEF" type="hidden" />
        <input name="access_token_ttl" value="0" type="hidden" />
      </form>

      <form
        id="office_form_embedXls"
        name="office_form"
        target="office_frame"
        action="http://mikee-oos/x/_layouts/xlembed.aspx?&WOPISrc=http%3A%2F%2Fwopi-server:3000%2Fwopi%2Ffiles%2Ftest1.xlsx&access_token=DEADBEEFDEADBEEFDEADBEEF&access_token_ttl=0"
        method="post"
      >
        <input name="src" value="http://wopi-server:3000%2fSampleHostPage.html/wopi/files/test1.xlsx" type="hidden" />
        <input name="access_token" value="DEADBEEFDEADBEEFDEADBEEF" type="hidden" />
        <input name="access_token_ttl" value="0" type="hidden" />
      </form>

      <form
        id="office_form_vwPpt"
        name="office_form"
        target="office_frame"
        action="http://mikee-oos/p/PowerPointFrame.aspx?PowerPointView=ReadingView?&WOPISrc=http%3A%2F%2Fwopi-server:3000%2Fwopi%2Ffiles%2Fppt3.pptx&access_token=DEADBEEFDEADBEEFDEADBEEF&access_token_ttl=0"
        method="post"
      >
        <input name="src" value="http://wopi-server:3000%2fSampleHostPage.html/wopi/files/ppt3.pptx" type="hidden" />
        <input name="access_token" value="DEADBEEFDEADBEEFDEADBEEF" type="hidden" />
        <input name="access_token_ttl" value="0" type="hidden" />
      </form>

      <form
        id="office_form_vwPdf"
        name="office_form"
        target="office_frame"
        action="http://mikee-oos/wv/wordviewerframe.aspx?PdfMode=1&WOPISrc=http%3A%2F%2Fwopi-server:3000%2Fwopi%2Ffiles%2FMS-WOPI.pdf&access_token=DEADBEEFDEADBEEFDEADBEEF&access_token_ttl=0"
        method="post"
      >
        <input name="src" value="http://wopi-server:3000%2fSampleHostPage.html/wopi/files/[MS-WOPI].pdf" type="hidden" />
        <input name="access_token" value="DEADBEEFDEADBEEFDEADBEEF" type="hidden" />
        <input name="access_token_ttl" value="0" type="hidden" />
      </form>

      <!-- The Modal -->
      <!--<div id="myModal" class="modal">-->

      <!-- Modal content -->
      <!--<div class="modal-content">
				<span class="close">&times;</span>
				<h1>
					<p>WOPI Edit Window</p>
				</h1>-->
      <span id="frameholder"></span>
      <!--</div>

		</div>-->

      <script type="text/javascript">
        window.addEventListener('message', receiver, false)
        function receiver(e) {
          // The actual message is contained in the data property of the event.
          var msg = JSON.parse(e.data)
          // const {data: msg, data: {MessageId: msgId, Values: msgData}} = e;
          alert(msg.MessageId)

          // The message ID is now a property of the message object.
          var msgId = msg.MessageId

          // // The message parameters themselves are in the Values
          // // parameter on the message object.
          var msgData = msg.Values

          console.log(msg)
          // Do something with the message here.

          if (msgId === 'UI_Close') {
            console.log('Got a UI_Close, navigating back to the host page.')
            // window.location.href = "http://localhost/Closed.html";
          }
        }
        var x = 'Language of the browser: ' + navigator.language
        document.getElementById('demo').innerHTML = x
        console.log(x)
        x = 'User language of the browser: ' + navigator.userLanguage
        document.getElementById('demo_user').innerHTML = x
        console.log(x)
        x = 'Browser language of the browser: ' + navigator.browserLanguage
        document.getElementById('demo_browser').innerHTML = x
        console.log(x)
        x = 'System language of the browser: ' + navigator.systemLanguage
        document.getElementById('demo_system').innerHTML = x
        console.log(x)

        //// handler with modal dialog
        //$('.wopi_vw_button').click(function (event) {
        //	// Get the modal
        //	var modal = document.getElementById('myModal');

        //	// Get the <span> element that closes the modal
        //	var span = document.getElementsByClassName("close")[0];

        //	var frameholder = document.getElementById('frameholder');
        //	var office_frame = document.createElement('iframe');
        //	office_frame.name = 'office_frame';
        //	office_frame.id = 'office_frame';

        //	// This attribute allows true fullscreen mode in slideshow view
        //	// when using PowerPoint Online's 'view' action.
        //	//office_frame.setAttribute('allowfullscreen', 'true');

        //	office_frame.src = "http://mikee-oos/wv/wordviewerframe.aspx?WOPISrc=http%3A%2F%2Fwopi-server:3000%2Fwopi%2Ffiles%2FTest2.docx&access_token=DEADBEEFDEADBEEFDEADBEEF&access_token_ttl=0";
        //	frameholder.appendChild(office_frame);

        //	modal.style.display = "block";
        //	//document.getElementById('office_form_' + event.target.id).submit();

        //	// When the user clicks on <span> (x), close the modal
        //	span.onclick = function () {
        //		modal.style.display = "none";
        //	}

        //	// When the user clicks anywhere outside of the modal, close it
        //	window.onclick = function (event) {
        //		if (event.target == modal) {
        //			modal.style.display = "none";
        //		}
        //	}

        //});

        // original button handler...
        $('.wopi_vw_button').click(function (event) {
          var frameholder = document.getElementById('frameholder')
          var office_frame = document.createElement('iframe')
          office_frame.name = 'office_frame'
          office_frame.id = 'office_frame'

          // This attribute allows true fullscreen mode in slideshow view
          // when using PowerPoint Online's 'view' action.
          //office_frame.setAttribute('allowfullscreen', 'true');

          frameholder.appendChild(office_frame)

          document.getElementById('office_form_' + event.target.id).submit()
        })

        $('.wopi_pv_button').click(function (event) {
          var frameholder = document.getElementById('frameholder')
          var office_frame = document.createElement('iframe')
          office_frame.name = 'office_frame'
          office_frame.id = 'office_frame'

          // This attribute allows true fullscreen mode in slideshow view
          // when using PowerPoint Online's 'view' action.
          //office_frame.setAttribute('allowfullscreen', 'true');

          frameholder.appendChild(office_frame)

          document.getElementById('office_form_' + event.target.id).submit()
        })

        $('.wopi_em_button').click(function (event) {
          var frameholder = document.getElementById('frameholder')
          var office_frame = document.createElement('iframe')
          office_frame.name = 'office_frame'
          office_frame.id = 'office_frame'

          // This attribute allows true fullscreen mode in slideshow view
          // when using PowerPoint Online's 'view' action.
          //office_frame.setAttribute('allowfullscreen', 'true');

          frameholder.appendChild(office_frame)

          document.getElementById('office_form_' + event.target.id).submit()
        })
      </script>
    </div>
  </body>
</html>
